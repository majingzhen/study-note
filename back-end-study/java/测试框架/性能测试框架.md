# 性能测试

## 性能测试是什么

性能测试是通过自动化的测试工具模拟多种正常、峰值以及异常负载条件来对系统的各项性能指标进行测试。

## 为什么需要性能测试

一个查询功能，用户点击查询，10S 种才返回数据，功能上是满足的，但是性能上是不能接受的。

线上的交易功能平时各方面都很棒，节假日高峰期直接系统就瘫痪了。

那如何避免这些问题出现在生产上呢？

这就需要上线之前，首先做好对应的性能测试，避免再生产上出现问题，带来严重的生产事故。

## 如何做好性能测试

我们先想一下性能测试，到底要测试什么？

有些类似于开发过程中的需求分析，常见的测试指标如下。

### 测试指标

#### 响应时间

响应时间是指某个请求或操作从发出到接收到反馈所消耗的时间，包括应用服务器（客户端）处理时间、网络传输时间以及数据库服务器处理时间。

作为用户而言，在页面点击查询，等待了多久才能获取结果，这个就是响应时间。

#### TPS/QPS

TPS（Transaction Per Second）是指单位时间（每秒）系统处理的事务量。

个人看来本质上 TPS/QPS 就是去压测你应用的极限，当访问量较大的时候，程序能否活下来？

这里主要涉及到两个概念：高性能和高可用。

### 测试报告

当进行测试之后，测试的结果一定要给出一份报告出来。

是否通过压测要求？

最高的 QPS 是多少？

这样开发可以根据这份报告进行相应的优化。

## 常见的性能测试工具

### jmeter

Apache JMeter 可以用于测试静态和动态资源(Web动态应用程序)的性能。

它可以用于模拟服务器、服务器组、网络或对象上的负载，以测试其强度或分析不同负载类型下的总体性能。

##### LoadRunner

LoadRunner是一款适用于各种体系架构的性能测试工具，它能预测系统行为并优化系统性能，其工作原理是通过模拟一个多用户(虚拟用户)并行工作的环境来对应用程序进行负载测试。在进行负载测试时，LoadRunner能够使用最少的硬件资源为模拟出来的虚拟用户提供一致的、可重复并可度量的负载，在测试过程中监控用户想要的数据和参数。

缺点：付费，价格高

### Gatling

Gatling是一款基于Scala 开发的高性能服务器性能测试工具，它主要用于对服务器进行负载等测试，并分析和测量服务器的各种性能指标。目前仅支持http协议，可以用来测试web应用程序和RESTful服务。

缺点：需要使用Scala语言来进行脚本的编写，需要一定的学习成本。

## junitperf

[junitperf](https://github.com/houbb/junitperf) 是一款为 Java 开发者设计的性能测试框架，具有以下特点：

- 可以和 Junit5 完美契合。

- 使用简单，便于项目开发过程中的测试实用。

- 提供拓展，用户可进行自定义开发。

- 支持多种报告生成方式，支持自定义

### JMH
